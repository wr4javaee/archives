---
layout: post
title:  "数据库学习笔记 - 数据库保护"
date:   2016-05-25 17:08:12
categories: Database
excerpt: 数据库 事务 transaction acid lock
---

* content
{:toc}

## 什么是事务（Transaction）

事务是用户定义的数据操作系列，这些操作可作为一个完整的工作单元（数据库的逻辑工作单位）。

---



## 事务的特性（ACID）

* 原子性（Atomicity）事务中的操作要么都做，要么都不做。
* 一致性（Consistency）只有合法的数据可以被写入数据库，否则事务应该将其回滚到最初状态。
* 隔离性（Isolation）数据库中一个事务的执行不能被其他事务干扰。
* 持久性（Durability）事务一旦提交，其对数据库中数据的改变就是永久的。

---



## 并发控制

并发问题导致的异常情况归类如下：

#### 丢失更新（Lost Update）

两个事务都同时更新一行数据，第一个事务的提交结果被第二个事务的提交结果破坏。



![lost_update]({{site.url}}{{site.baseurl}}/images/db/transaction/2016_05_26_lost_update.png)



#### 脏读（Dirty Reads）

一个事务读了某个失败事务运行过程中的数据。

![ldirty_reads]({{site.url}}{{site.baseurl}}/images/db/transaction/2016_05_26_dirty_reads.png)



#### 不可重复读（Non-repeatable Reads）

一个事务对同一行数据重复读取两次，但是却得到了不同的结果。

![non_repeatable_reads]({{site.url}}{{site.baseurl}}/images/db/transaction/2016_05_26_non_repeatable_reads.png)



#### 幻读（Phantom Reads）

幻读实际属于不可重复读的范畴。它指当事务T1按照一定条件读取某些数据，事务T2对其中部分记录做了删除或更新操作，当事务T1再次以相同条件读取数据时，发现少或多了某些记录。
